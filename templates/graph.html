{% extends "base.html"   %}

{% block head %}

{% endblock %}

{% block body %}
<div class = "content">
  <h1   style="text-align:center">   N_O_W_H_E_R_E  </h1>
  <form action="/" method="GET" style="text-align:center" >
      <input type="submit" value="Go to Picture">
  </form>

  <svg width = "960" height = "450" >
  </svg>



  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script>





 d3.csv('/graph/data/endpoint')
   .then(data => {
   data.forEach(d => {
     d.x_v = +d.x_v;
     d.y_v = +d.y_v;
   })
 	 console.log(data);

   const svg = d3.select('svg');
   const width = +svg.attr('width');
   const height = +svg.attr('height');

   const xAxislabel = 'Variable 1';
   const yAxislabel = 'Variable 2'


   const margin = {top: 50 , right: 50 , bottom: 100, left: 50};
   const innerwidth = width - margin.left - margin.right;
   const innerheight = height - margin.top - margin.bottom;



 const xValue =  d => d.x_v;
 const yValue = d => d.y_v;


   // xScale
 const xScale = d3.scaleLinear()
       .domain(d3.extent(data,xValue))
       .range([0 , innerwidth]);

 // y Scale
 const yScale = d3.scaleLinear()
   .domain(d3.extent(data,yValue))
   .range([innerheight,0]);

   const g = svg.append('g')
   	.attr('transform', `translate(${margin.left}, ${margin.top})`);



    const yAxis = d3.axisLeft(yScale)
    			.tickSize(-innerwidth)


      const  yAxisG = g.append('g').call(yAxis);

    const xAxis = d3.axisBottom(xScale)
    .tickSize(-innerheight);


    const  xAxisG =  g.append('g').call(xAxis)
    		.attr('transform', `translate(0, ${innerheight})`);


  xAxisG.selectAll('.domain')
    .remove();
  yAxisG.selectAll('.domain')
    .remove();



   g.selectAll('circle').data(data)
     .enter().append('circle')
     .transition()
      .duration(1000)
     .attr('cy', d => yScale(yValue(d)) )
     .attr('cx', d => xScale(xValue(d)) )
     .attr('r', 6);


 });




  </script>
</div>

{% endblock %}
